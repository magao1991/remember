/*!
 * author:jieyou
 * contacts:baidu hi->youyo1122
 * see https://github.com/jieyou/remember
 */
!function(a){function b(b){function c(){document.removeEventListener("DOMContentLoaded",c,!1),a.removeEventListener("load",c,!1),b.call(document)}"complete"===document.readyState?setTimeout(c):(document.addEventListener("DOMContentLoaded",c,!1),a.addEventListener("load",c,!1))}function c(a){var b=a.tagName;return b?b.toUpperCase():null}function d(){return m||(m=encodeURIComponent(n.ignoreSearchStringInUrl?location.href.split("?")[0]:location.href.replace(location.hash,""))+"__"),m}function e(a){return"string"==typeof a&&(a=document.getElementById(a)),a&&1===a.nodeType?a:document}function f(a){return"submit"!==a&&"button"!==a&&"hidden"!==a&&"image"!==a&&"file"!==a&&"reset"!==a}function g(a,b){if(a===b)return!0;if(a.compareDocumentPosition){if(20===a.compareDocumentPosition(b))return!0}else if(a.contains&&a.contains(b))return!0;return!1}function h(){var a;try{if(a=localStorage.getItem(n.localStorageKeyPrefix+d()))return a}catch(b){}return null}function i(a){var b,c,e,f,g=h(),i=[];if(g&&(c={},b=g.split("&"),q.call(b,function(a){var b=a.split("=");c[b[0]]=b[1]})),c)for(e in a)c[e]=a[e];else c=a;for(f in c)i.push(f+"="+c[f]);try{localStorage.setItem(n.localStorageKeyPrefix+d(),i.join("&"))}catch(j){}}function j(a,b){b=b||{},this.wrapperDOM=a,this.handleSetValueFromCacheFuncs=b.handleSetValueFromCacheFuncs||{},this.ignoreIds=b.ignoreIds||[]}function k(a){a._changeEventFunc=function(b){var d,e,f=b.target,g=c(f),h=f.id;return h&&-1!==a.ignoreIds.indexOf(h)?!0:("SELECT"===g?e=!0:"INPUT"===g&&(d=f.type,("checkbox"===d||"radio"===d)&&(e=!0)),void(e&&i(a.getKvObj())))},a.wrapperDOM.addEventListener("change",a._changeEventFunc,!0),a._blurEventFunc=function(b){var d,e=b.target,g=c(e),h=e.id,j=e.type;return h&&-1!==a.ignoreIds.indexOf(h)?!0:void(("INPUT"===g&&"checkbox"!==j&&"radio"!==j&&f(j)||"TEXTAREA"===g)&&(d=e.value,"TEXTAREA"===g&&(d=d.replace(/\n/g,n.textareaLineFeedHolder)),d!==e.getAttribute(n.oldValueAttributeName)&&(e.setAttribute(n.oldValueAttributeName,d),i(a.getKvObj()))))},a.wrapperDOM.addEventListener("blur",a._blurEventFunc,!0)}function l(a,c){var d,f=!1;if(a=e(a),r.call(p,function(b){return g(b,a)||g(a,b)?(f=!0,!0):void 0}),f)throw new Error("Specified `wrapperDOM` has been occupied or has been included by another occupied `wrapperDOM` or has another occupied `wrapperDOM` included.");return p.push(a),d=new j(a,c),b(function(){var a=h();o&&(a&&d.setValue(a),k(d))}),d}var m,n={noValueRadioIndexPrefix:"__R_NVRIP__",oldValueAttributeName:"data-roldvalue",textareaLineFeedHolder:"__R_TLFH_ramdom_769768842_ramdom_",localStorageKeyPrefix:"__R_LSK__",ignoreSearchStringInUrl:!1},o="localStorage"in window,p=[],q=Array.prototype.forEach,r=Array.prototype.some;j.prototype.setValue=function(a){var b=a.split("&"),d=this;q.call(b,function(a){var b,e,h,i,j,k=a.split("="),l=k[0],m=document.getElementById(l),o=k[1];m&&-1===d.ignoreIds.indexOf(l)&&g(d.wrapperDOM,m)&&(h=!0,thisHandleSetValueFromCacheFunc=d.handleSetValueFromCacheFuncs[l],"function"==typeof thisHandleSetValueFromCacheFunc&&(h=thisHandleSetValueFromCacheFunc.call(m,o,d.wrapperDOM)),h&&(b=c(m),"INPUT"===b?(e=m.type,"checkbox"===e?m.checked="1"===o:"radio"===e?(i=m.ownerDocument.getElementsByName(m.name),0===o.indexOf(n.noValueRadioIndexPrefix)?(o=parseInt(o.replace(n.noValueRadioIndexPrefix,"")),!isNaN(o)&&i[o]&&(i[o].checked=!0)):r.call(i,function(a){return a.value===o?(a.checked=!0,!0):void 0})):f(e)&&(m.setAttribute(n.oldValueAttributeName,o),m.value=o)):"TEXTAREA"===b?(m.setAttribute(n.oldValueAttributeName,o),m.value=o.replace(new RegExp(n.textareaLineFeedHolder,"g"),"\n")):"SELECT"===b?(j=m.getElementsByTagName("OPTION"),r.call(j,function(a,b){return a.value===o?(m.selectedIndex=b,!0):void 0})):m.value=o))})},j.prototype.getKvObj=function(){var a,b,d,e={},g=[],h=this,i=this.wrapperDOM,j=c(i);switch(j){case"SELECT":a=[i],b=[],d=[];break;case"TEXTAREA":a=[],b=[i],d=[];break;case"INPUT":a=[],b=[],d=[i];break;default:a=i.getElementsByTagName("SELECT"),b=i.getElementsByTagName("TEXTAREA"),d=i.getElementsByTagName("INPUT")}return q.call(a,function(a){var b=a,c=b.id;c&&-1===h.ignoreIds.indexOf(c)&&(e[c]=b.value)}),q.call(b,function(a){var b=a,c=b.id;c&&-1===h.ignoreIds.indexOf(c)&&(e[c]=b.value.replace(/\n/g,n.textareaLineFeedHolder))}),q.call(d,function(a){var b,c,d,i,j=a,k=j.id,l=null;k&&-1===g.indexOf(k)&&-1===h.ignoreIds.indexOf(k)&&(b=j.type,"checkbox"===b?l=j.checked?"1":"0":"radio"===b?(c=j.name,d=c?j.ownerDocument.getElementsByName(c):[j],q.call(d,function(a,b){a.checked&&!i&&(i=!0,l=a.getAttribute("value"),l||(l=n.noValueRadioIndexPrefix+b)),g.push(a.id)}),l||(l="")):f(b)&&(l=j.value),null!==l&&(e[k]=l))}),e},j.prototype.stop=function(){var a=this.wrapperDOM;a.removeEventListener("change",this._changeEventFunc,!0),a.removeEventListener("blur",this._blurEventFunc,!0),delete this._changeEventFunc,delete this._blurEventFunc,r.call(p,function(b,c){return b===a?(p.splice(c,1),!0):void 0})},l.configs=n,"function"==typeof define?define(function(){return l}):"undefined"!=typeof module&&null!==module?module.exports=l:a.remember=l}(function(){return this}());