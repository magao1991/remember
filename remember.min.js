/*!
 * author:jieyou
 * contacts:baidu hi->youyo1122
 * see https://github.com/jieyou/remember
 */
!function(a){function h(b){function c(){document.removeEventListener("DOMContentLoaded",c,!1),a.removeEventListener("load",c,!1),b.call(document)}"complete"===document.readyState?setTimeout(c):(document.addEventListener("DOMContentLoaded",c,!1),a.addEventListener("load",c,!1))}function i(a){var b=a.tagName;return b?b.toUpperCase():null}function j(){return d||(d=encodeURIComponent(b.ignoreSearchStringInUrl?location.href.split("?")[0]:location.href.replace(location.hash,""))+"__"),d}function k(a){return"string"==typeof a&&(a=document.getElementById(a)),a&&1===a.nodeType?a:document}function l(a){return"submit"!==a&&"button"!==a&&"hidden"!==a&&"image"!==a&&"file"!==a&&"reset"!==a}function m(a,b){if(a===b)return!0;if(a.compareDocumentPosition){if(20===a.compareDocumentPosition(b))return!0}else if(a.contains&&a.contains(b))return!0;return!1}function n(){var a;try{if(a=localStorage.getItem(b.localStorageKeyPrefix+j()))return a}catch(c){}return null}function o(a){var d,e,g,h,c=n(),i=[];if(c&&(e={},d=c.split("&"),f.call(d,function(a){var c=a.split("=");e[c[0]]=c[1]})),e)for(g in a)e[g]=a[g];else e=a;for(h in e)i.push(h+"="+e[h]);try{localStorage.setItem(b.localStorageKeyPrefix+j(),i.join("&"))}catch(k){}}function p(a,b){var c=this;switch(b=b||{},c.wrapperDOM=a,c.handleSetValueFromCacheFuncs=b.handleSetValueFromCacheFuncs||{},c.ignoreIds=b.ignoreIds||[],i(c.wrapperDOM)){case"SELECT":c.selects=[a],c.textareas=[],c.inputs=[];break;case"TEXTAREA":c.selects=[],c.textareas=[a],c.inputs=[];break;case"INPUT":c.selects=[],c.textareas=[],c.inputs=[a];break;default:c.selects=a.getElementsByTagName("SELECT"),c.textareas=a.getElementsByTagName("TEXTAREA"),c.inputs=a.getElementsByTagName("INPUT")}}function q(a){a._changeEventFunc=function(b){var f,g,c=b.target,d=i(c),e=c.id;return e&&-1!==a.ignoreIds.indexOf(e)?!0:("SELECT"===d||"TEXTAREA"===d?g=!0:"INPUT"===d&&(f=c.type,f&&"text"!==f&&"checkbox"!==f&&"radio"!==f&&"password"!==f&&"range"!==f||(g=!0)),g&&o(a.getKvObj()),void 0)},a.wrapperDOM.addEventListener("change",a._changeEventFunc,!0),a._blurEventFunc=function(c){var d=c.target,e=i(d),f=d.id,g=d.type;return f&&-1!==a.ignoreIds.indexOf(f)?!0:("INPUT"===e&&(g=d.type,g&&"text"!==g&&"checkbox"!==g&&"radio"!==g&&"password"!==g&&"range"!==g&&l(g)&&d.value!==d.getAttribute(b.oldValueAttributeName)&&(d.setAttribute(b.oldValueAttributeName,d.value),o(a.getKvObj()))),void 0)},a.wrapperDOM.addEventListener("blur",a._blurEventFunc,!0)}function r(a,b){var d,f=!1;if(a=k(a),g.call(e,function(b){return m(b,a)||m(a,b)?(f=!0,!0):void 0}),f)throw new Error("Specified `wrapperDOM` has been occupied or has been included by another occupied `wrapperDOM` or has another occupied `wrapperDOM` included.");return e.push(a),d=new p(a,b),h(function(){var a=n();c&&(a&&d.setValue(a),q(d))}),d}var d,b={noValueRadioIndexPrefix:"__R_NVRIP__",oldValueAttributeName:"data-roldvalue",textareaLineFeedHolder:"__R_TLFH_ramdom_769768842_ramdom_",localStorageKeyPrefix:"__R_LSK__",ignoreSearchStringInUrl:!1},c="localStorage"in window,e=[],f=Array.prototype.forEach,g=Array.prototype.some;p.prototype.setValue=function(a){var c=a.split("&"),d=this;f.call(c,function(a){var j,n,o,p,q,r,e=a.split("="),f=e[0],h=document.getElementById(f),k=e[1];h&&-1===d.ignoreIds.indexOf(f)&&m(d.wrapperDOM,h)&&(o=!0,r=d.handleSetValueFromCacheFuncs[f],"function"==typeof r&&(o=r.call(h,k,d.wrapperDOM)),o&&(j=i(h),"INPUT"===j?(n=h.type,"checkbox"===n?h.checked="1"===k:"radio"===n?(p=h.ownerDocument.getElementsByName(h.name),0===k.indexOf(b.noValueRadioIndexPrefix)?(k=parseInt(k.replace(b.noValueRadioIndexPrefix,"")),!isNaN(k)&&p[k]&&(p[k].checked=!0)):g.call(p,function(a){return a.value===k?(a.checked=!0,!0):void 0})):l(n)&&(h.setAttribute(b.oldValueAttributeName,k),h.value=k)):"TEXTAREA"===j?(h.setAttribute(b.oldValueAttributeName,k),h.value=k.replace(new RegExp(b.textareaLineFeedHolder,"g"),"\n")):"SELECT"===j?(q=h.getElementsByTagName("OPTION"),g.call(q,function(a,b){return a.value===k?(h.selectedIndex=b,!0):void 0})):h.value=k))})},p.prototype.getKvObj=function(){var a={},c=[],d=this;return f.call(d.selects,function(b){var e=b,f=e.id;f&&-1===d.ignoreIds.indexOf(f)&&(a[f]=e.value)}),f.call(d.textareas,function(c){var f=c,g=f.id;g&&-1===d.ignoreIds.indexOf(g)&&(a[g]=f.value.replace(/\n/g,b.textareaLineFeedHolder))}),f.call(d.inputs,function(e){var j,m,n,h=e,i=h.id,k=null,o=!1;i&&-1===c.indexOf(i)&&-1===d.ignoreIds.indexOf(i)&&(j=h.type,"checkbox"===j?k=h.checked?"1":"0":"radio"===j?(m=h.name,n=m?h.ownerDocument.getElementsByName(m):[h],f.call(n,function(a,d){a.checked&&!o&&(o=!0,k=a.getAttribute("value"),k||(k=b.noValueRadioIndexPrefix+d)),c.push(a.id)}),k||(k="")):l(j)&&(k=h.value),null!==k&&(a[i]=k))}),a},p.prototype.stop=function(){var a=this,b=a.wrapperDOM;b.removeEventListener("change",a._changeEventFunc,!0),b.removeEventListener("blur",a._blurEventFunc,!0),delete a._changeEventFunc,delete a._blurEventFunc,g.call(e,function(a,c){return a===b?(e.splice(c,1),!0):void 0})},r.configs=b,"function"==typeof define?define(function(){return r}):"undefined"!=typeof module&&null!==module?module.exports=r:a.remember=r}(function(){return this}());